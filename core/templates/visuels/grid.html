{% extends 'base.html' %}
{% block bhead %}
<!-- <link rel="stylesheet" href="/static/visuels/grid/grid.css"> -->
<script src="https://unpkg.com/infinite-scroll@4/dist/infinite-scroll.pkgd.js"></script>
<!--<script src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.js"></script>-->
<style>
  .grid__item {
    transition: transform .2s;
  }
  .grid__item:hover {
    transform: scale(1.1);
  }
</style>
{% endblock %}
{% block body %}

<div class="filters">

{% include "_navbar.html" %}

<div class="container">
  <div class="wrap-container-main">
    <div class="panel panel-default panel-filters">
      <div class="panel-body">

        <div class="container-fluid mt-4">

          <section class="row grid-p">


            <div class="col-xs-4 col-md-1 col-lg-1">
              <span class="subtitle">Chapitre</span>
            </div>
            <div class="col-xs-8 col-md-8 col-lg-9">
              <select  onchange="window.location = '/visuels/'+this.options[this.selectedIndex].value;" class="form-control border-20" data-val="true" data-val-number="The field Chapitre must be a number."
                data-val-required="The Chapitre field is required." id="Chapitre" name="Chapitre">
                <option {% if p == '0' %}selected="selected"{% endif %} value="0">Tous</option>
                {% for chapter in chapitres %}
                <option {% if chapter.number == p %}selected="selected"{% endif %} value="{{ chapter.number }}">{{ chapter.title }}</option>
                {% endfor %}
              </select>
            </div>
            <!--<div class="col-xs-12 col-md-3 col-lg-2">
              <button class="btn border-20 btn-block btn-kootour-bold btn-search" type="submit">Filtrer</button>

            </div>-->


          </section>

        </div>
      </div>
    </div>
    <div class="grid">
      {% include 'visuels/grid_page.html' %}
    </div>



  </div>
</div>
<script>
  function getPath() {
      return '/visuelsp/{{p}}/'+ (2+this.loadCount);
  }
  //-------------------------------------//

  let grid = document.querySelector('.grid');


  //-------------------------------------//
  // init Infinte Scroll

  let infScroll = new InfiniteScroll( grid, {
    path: getPath,
    append: '.grid__item',
  });

  const copyLink = document.querySelector(".copy-img");

  copyLink.addEventListener('click', e => {
    if(e.target.classList.contains('btn-copy')) {
      const link = window.location.origin + e.target.dataset.link;
      e.target.classList.add('copied');
      navigator.clipboard.writeText(link);
      setTimeout(() => {
        e.target.classList.remove('copied');
      }, 1000);
    }
  })

</script>
{% include '_footer.html' %}
</div>





{% endblock %}
